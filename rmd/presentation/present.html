<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Reading Between the Wines…</title>
    <meta charset="utf-8" />
    <meta name="author" content="Garrett Hawes | Ricky Lobel | Bart" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Reading Between the Wines…
## Some subtitle
### Garrett Hawes | Ricky Lobel | Bart
### Chapman University
### 2019/10/20 (updated: 2019-11-21)

---

&lt;!-- background-image: url(https://camo.githubusercontent.com/06e0a35a7e3014fe8c7f009d2f6bfacf14cefa93/687474703a2f2f6761727265747468617765732e636f6d2f722f636f7665722e6a706567) --&gt;






???

Image credit: Artwork by Garrett Hawes, base wine bottle from adobe stock

---
class: inverse, center, middle

# Intro

---
# Load Data 

```r
load(here::here("data","output","clean_wine.RData"))

x&lt;-213
```
---
# Plots 
---
# Maps 


```r
world_map &lt;- map_data("world")
world_map &lt;-
  world_map %&gt;% dplyr::mutate(region = ifelse(region == "USA", "US", region))
world_map &lt;- world_map %&gt;% dplyr::mutate(country = region)

wine_map_DF &lt;-
  wine_data_clean  %&gt;% dplyr::mutate(country = as.character(country)) %&gt;%
  dplyr::filter (country != "England" &amp;
            country != "US-France" &amp;
            country != "")

# Generate Summary
wmap &lt;-
  wine_data_clean %&gt;%
  dplyr::group_by(country) %&gt;%
  dplyr::summarize(
    point_min = min(points, na.rm = TRUE),
    point_avg = mean(points, na.rm = TRUE),
    point_max = max(points, na.rm = TRUE),
    price_min = min(price, na.rm = TRUE),
    price_avg = mean(price, na.rm = TRUE),
    price_max = max(price, na.rm = TRUE)
  ) %&gt;%
  dplyr::select(
    c(
      "country",
      "point_min",
      "point_avg",
      "point_max",
      "price_min",
      "price_avg",
      "price_max"
    )
  )
# Create data frame with bounderies and values
wine_country_map &lt;- right_join(wmap, world_map, by = "country")

#scale_fill_viridis_c(option = "C", limits = c(80, 100))

.map_from_attribute &lt;- function(att, title) {
  return(
    ggplot(wine_country_map, aes_string(map_id = "country", fill = att)) +
      geom_map(map = wine_country_map,  color = "white") +
      expand_limits(x = wine_country_map$long, y = wine_country_map$lat) +
      scale_fill_viridis_c(option = "C") + theme_map() + ggtitle(title) + 
      theme(plot.title = element_text(hjust = 0.5, size=20)) +
      theme(legend.title = element_blank()) 
  )
}
```
---
# Points - Min

```r
.map_from_attribute("point_min", "Minimum Points")
```

![](present_files/figure-html/unnamed-chunk-2-1.png)&lt;!-- --&gt;
---
# Points - Average

```r
.map_from_attribute("point_avg", "Average Points")
```

![](present_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;
---
# Points - Max

```r
.map_from_attribute("point_max", "Maximum Points") 
```

![](present_files/figure-html/unnamed-chunk-4-1.png)&lt;!-- --&gt;
---
# Price - Min

```r
.map_from_attribute("price_min", "Minimum Price") 
```

![](present_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;
---
# Price - Average

```r
.map_from_attribute("price_avg", "Average Price") 
```

![](present_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
---
# Price - Max

```r
.map_from_attribute("price_max", "Maximum Price") 
```

![](present_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;
# Price v Points


```r
p &lt;- ggplot(wine_data_clean, aes(points, price, color = point_cat)) + 
      geom_point() + 
      theme_clean() + 
      labs(color = "Rating Category", title = "Price vs Points") +
      theme(plot.title = element_text(hjust = 0.5)) 
p1 &lt;- ggMarginal(p, type="histogram", fill="slateblue") 
p1 
```

![](present_files/figure-html/plot2-1.png)&lt;!-- --&gt;
---
# Price v Points (y log 10 scale)

![](present_files/figure-html/plot3-1.png)&lt;!-- --&gt;
---
# Box Plot

```r
wine_data_clean %&gt;% 
  ggplot( aes(x = reorder(color_lump, points), 
              y = points, 
              fill = color_lump)) + 
  geom_boxplot() + 
  xlab("Color") +
  labs(x="Color", 
       y="Points", 
       title="Wine Score by color", 
       caption="Faceted by Gender") + 
  theme_clean() + 
  theme(legend.position = "none", 
        plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~ country_lump)
```

![](present_files/figure-html/plot4-1.png)&lt;!-- --&gt;
---

```r
ggplot(data = wine_data_clean) +
  geom_hex(mapping = aes(x = points, y = price))
```

![](present_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;
---
# Price v Score faceted by Gender

```r
ggplot(wine_data_clean, 
       aes(points, price, color = point_cat)) + 
  geom_point() + 
  scale_y_log10()+
  theme_clean() + 
  labs(color = "Rating Category", 
       title = "Price v Score by Taster Gender", 
       x="Score", 
       y="Price", 
       caption="Price is scaled to log 10" ) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~ taster_gender)
```

![](present_files/figure-html/plot5-1.png)&lt;!-- --&gt;
---
# Price v Points by Country

```r
ggplot(wine_data_clean, 
       aes(y=price, 
           x=points, 
           color = point_cat)) + 
  geom_point(alpha=1/2) + 
  geom_smooth() +
  scale_y_log10()+
  theme_clean()+
  theme(plot.title = element_text(hjust = 0.5))+
  labs(color="Rating Category", 
       title = "Score vs log of Price") + 
  facet_wrap(~ country_lump)
```

![](present_files/figure-html/plot6-1.png)&lt;!-- --&gt;
---
# Price by Country

```r
ggplot(wine_data_clean, 
       aes(y = price, 
           x = country_lump, 
           color = point_cat)) +
  theme_clean()+
  theme(plot.title = element_text(hjust = 0.5))+
  coord_flip()+
  geom_jitter(alpha=1/2) + 
  labs(color="Rating Category", 
       title="Price and Country Colored by Rating Category", 
       x="Country", 
       y="Price")
```

![](present_files/figure-html/plot7-1.png)&lt;!-- --&gt;
---
# Country v Price (log10 scale)


```r
ggplot(wine_data_clean, 
       aes(x = country_lump, 
           y = price, 
           color = point_cat)) + 
  scale_y_log10() +
  geom_jitter(alpha=1/2) + 
  coord_flip() +
  labs(color = "Rating Category", 
       title="Price by Country", 
       caption="Price is scaled to log 10", 
       x = "Country", 
       y="Price") +
    theme_clean()  +
  theme(plot.title = element_text(hjust = 0.5))
```

![](present_files/figure-html/plot8-1.png)&lt;!-- --&gt;
---
# Taster Tweets v log(Price)

```r
  ggplot(wine_data_clean, 
         aes(y = price, 
             x = taster_n_tweets, 
             color = point_cat)) +
  theme_clean()+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_log10()+
  scale_y_log10()+
  geom_jitter(alpha=1/2) + 
  labs(color="Rating Category", 
       title="Price v Number of Tweets", 
       x="Number of Tweets from Taster", 
       y="Price", 
       caption="Price and Teets Scaled to log 10")
```

![](present_files/figure-html/plot9-1.png)&lt;!-- --&gt;
---
# Session info


```r
sessionInfo()
```

```
## R version 3.6.1 (2019-07-05)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] xaringanthemer_0.2.0       wordcloud_2.6              RColorBrewer_1.1-2         SnowballC_0.6.0            tm_0.7-6                  
##  [6] NLP_0.2-0                  sentimentr_2.8.0           PerformanceAnalytics_1.5.3 xts_0.11-2                 zoo_1.8-6                 
## [11] stringi_1.4.3              ggmap_3.0.0                GGally_1.4.0               ggthemes_4.2.0             ggExtra_0.9               
## [16] kableExtra_1.1.0           knitr_1.26                 forcats_0.4.0              stringr_1.4.0              dplyr_0.8.3               
## [21] purrr_0.3.3                readr_1.3.1                tidyr_1.0.0                tibble_2.1.3               ggplot2_3.2.1             
## [26] tidyverse_1.2.1            arsenal_3.3.0              here_0.1                   conflicted_1.0.4           DT_0.10                   
## 
## loaded via a namespace (and not attached):
##  [1] colorspace_1.4-1  rjson_0.2.20      ellipsis_0.3.0    qdapRegex_0.7.2   rprojroot_1.3-2   fs_1.3.1          rstudioapi_0.10   xaringan_0.13.1  
##  [9] remotes_2.1.0     lubridate_1.7.4   textclean_0.9.3   xml2_1.2.2        splines_3.6.1     pkgload_1.0.2     zeallot_0.1.0     jsonlite_1.6     
## [17] packrat_0.5.0     broom_0.5.2       servr_0.15        png_0.1-7         shiny_1.4.0       compiler_3.6.1    httr_1.4.1        backports_1.1.5  
## [25] assertthat_0.2.1  Matrix_1.2-17     fastmap_1.0.1     lazyeval_0.2.2    cli_1.1.0         later_1.0.0       prettyunits_1.0.2 htmltools_0.4.0  
## [33] tools_3.6.1       gtable_0.3.0      glue_1.3.1        maps_3.3.0        Rcpp_1.0.3        slam_0.1-46       cellranger_1.1.0  lexicon_1.2.1    
## [41] vctrs_0.2.0       nlme_3.1-141      xfun_0.11         ps_1.3.0          testthat_2.3.0    rvest_0.3.5       mime_0.7          miniUI_0.1.1.1   
## [49] lifecycle_0.1.0   devtools_2.2.1    scales_1.0.0      hms_0.5.2         promises_1.1.0    parallel_3.6.1    curl_4.2          yaml_2.2.0       
## [57] memoise_1.1.0     reshape_0.8.8     desc_1.2.0        pkgbuild_1.0.6    RgoogleMaps_1.4.4 rlang_0.4.1       pkgconfig_2.0.3   bitops_1.0-6     
## [65] evaluate_0.14     lattice_0.20-38   htmlwidgets_1.5.1 labeling_0.3      processx_3.4.1    tidyselect_0.2.5  plyr_1.8.4        magrittr_1.5     
## [73] R6_2.4.1          generics_0.0.2    pillar_1.4.2      haven_2.2.0       withr_2.1.2       mgcv_1.8-29       modelr_0.1.5      crayon_1.3.4     
## [81] rmarkdown_1.17.4  usethis_1.5.1     jpeg_0.1-8.1      syuzhet_1.0.4     grid_3.6.1        readxl_1.3.1      data.table_1.12.6 callr_3.3.2      
## [89] digest_0.6.22     webshot_0.5.1     xtable_1.8-4      httpuv_1.5.2      munsell_0.5.0     viridisLite_0.3.0 sessioninfo_1.1.1 quadprog_1.5-7
```
---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "solarized-dark",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
